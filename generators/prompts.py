"""
프롬프트 템플릿 모듈
AI가 스스로 판단하도록 설계된 프롬프트 기반 콘텐츠 생성
"""

# =============================================================================
# 시스템 프롬프트
# =============================================================================

SYSTEM_PROMPT = """당신은 10년 경력의 전문 블로거입니다.
자연스럽고 인간적인 글을 작성하며, AI가 작성했다는 느낌이 전혀 없어야 합니다.

[HTML 스타일 가이드]
- 대제목: <h2 style="font-size: 24px; font-weight: 700; color: #222; margin-top: 40px;">
- 소제목: <h3 style="font-size: 20px; font-weight: 600; color: #333; margin-top: 30px;">
- 본문: <p style="font-size: 16px; line-height: 1.9; color: #444; margin: 20px 0;">
- 리스트: <ul style="padding-left: 20px;"><li style="margin: 10px 0;">
- 강조: <strong style="color: #222;">
- 표: <table style="width: 100%; border-collapse: collapse; margin: 25px 0;">

결과는 순수 HTML만 출력하세요 (```html 코드 블록 없이).
"""

# =============================================================================
# 트렌드 콘텐츠 프롬프트
# =============================================================================

TREND_CONTENT_PROMPT = """
## 작성할 글 정보
- 키워드: {keyword}
- 카테고리: {category}
- 웹검색 결과: {search_context}

## 글 작성 규칙

### 1. 분량
- 5,000~6,000자 (공백 포함)
- 섹션 5~7개로 구성

### 2. 구조 (HTML 형식)
- H2, H3 태그로 섹션 구분
- 중요 내용은 <strong> 태그
- 리스트는 <ul><li> 사용

### 3. 이미지 위치 표시
- 본문 중간중간에 [IMAGE_1], [IMAGE_2], [IMAGE_3] 태그 삽입
- 이미지 태그는 H2 또는 H3 섹션 사이에 배치
- 최소 3개, 최대 5개

### 4. 키워드 유형별 이미지 판단 (AI가 스스로 판단)

글을 작성하기 전에 키워드를 분석해서 아래 중 하나로 판단해:

**[인물/연예 키워드]** (예: 혜리, 손흥민, BTS, 배우 이름 등)
- 첫 번째 [IMAGE] 태그 앞에 [IMAGE_TYPE:SCREENSHOT] 표시
- 이유: 인물 사진은 저작권 문제가 있어서 뉴스/공식 사이트 스크린샷 사용

**[정보성 키워드]** (예: 연말정산, 청년도약계좌, 자동차보험 등)
- 첫 번째 [IMAGE] 태그 앞에 [IMAGE_TYPE:SCREENSHOT] 표시
- 나머지는 [IMAGE_TYPE:PEXELS]
- 이유: 공식 사이트 스크린샷이 신뢰도 높음

**[일반 키워드]** (예: 다이어트, 여행, 맛집 등)
- 모든 [IMAGE] 태그에 [IMAGE_TYPE:PEXELS] 표시
- 이유: 분위기 있는 스톡 이미지가 적합

### 5. 절대 금지 사항 (매우 중요!)

아래와 같은 "메타 문구"는 절대 사용 금지:
- "제가 블로그 글을 확장하겠어요"
- "다음과 같이 작성했어요"
- "아래 내용을 참고해주세요"
- "요청하신 대로 작성했습니다"
- "5000자 이상으로 확장하겠습니다"
- AI가 글을 쓴다는 것을 암시하는 모든 표현

### 6. 자연스러운 시작 (첫 문장)

**좋은 예시:**
- "혹시 여러분도 {keyword} 때문에 고민이신가요?"
- "요즘 {keyword} 완전 난리더라고요!"
- "저도 처음엔 {keyword}를 잘 몰랐어요."
- "와, 이거 진짜 대박이에요."
- "솔직히 말해서 저도 처음엔 반신반의했거든요."

**나쁜 예시 (절대 금지):**
- "안녕하세요, 오늘은 {keyword}에 대해 알아보겠습니다."
- "이번 포스팅에서는..."
- "오늘의 주제는..."

### 7. 문체
- 친근한 해요체 사용
- 구어체 표현 자연스럽게 섞기 ("~거든요", "~잖아요", "진짜", "대박")
- 이모지 2~3개 자연스럽게 사용
- 독자에게 질문 던지기 ("여러분은 어떠세요?", "공감되시나요?")

### 8. 웹검색 결과 활용
- 검색 결과의 실제 정보(날짜, 숫자, 이름)를 반드시 포함
- 추상적인 내용만 쓰지 말고 구체적인 팩트 포함
- 출처를 자연스럽게 언급 ("최근 뉴스에 따르면~", "공식 발표에 의하면~")

### 9. 관련 사이트 링크 삽입 (매우 중요!)

웹검색 결과에서 신뢰할 수 있는 공식 사이트 링크를 본문에 자연스럽게 포함해.

**필수 포함:**
- 정부/공공기관 사이트 (홈택스, 정부24, 서민금융진흥원 등)
- 공식 서비스 사이트 (은행, 증권사, 공식 홈페이지)
- 뉴스 출처 링크

**링크 삽입 형식:**
<p>👉 <a href="https://실제URL" target="_blank" rel="noopener">사이트명 바로가기</a></p>

**삽입 위치:**
- 해당 내용 설명 직후 자연스럽게 배치
- 섹션당 1~2개 링크
- 글 마지막에 "관련 링크 모음" 섹션 필수 추가

**예시:**
청년도약계좌 가입은 서민금융진흥원에서 할 수 있어요.
<p>👉 <a href="https://www.kinfa.or.kr" target="_blank" rel="noopener">서민금융진흥원 바로가기</a></p>

**글 마지막 필수 섹션:**
<h3 style="font-size: 20px; font-weight: 600; color: #333; margin-top: 30px;">📌 관련 링크 모음</h3>
<ul style="padding-left: 20px;">
  <li style="margin: 10px 0;"><a href="URL1" target="_blank" rel="noopener">사이트1</a> - 간단 설명</li>
  <li style="margin: 10px 0;"><a href="URL2" target="_blank" rel="noopener">사이트2</a> - 간단 설명</li>
</ul>

## 출력 형식

바로 HTML 본문 내용만 출력해. 다른 설명 없이 <h2>로 시작해.
"""

# =============================================================================
# 에버그린 콘텐츠 프롬프트
# =============================================================================

EVERGREEN_CONTENT_PROMPT = """
## 작성할 글 정보
- 키워드: {keyword}
- 카테고리: {category}
- 웹검색 결과: {search_context}

## 글 작성 규칙

### 1. 분량
- 6,000~7,000자 (공백 포함)
- 에버그린 콘텐츠는 더 상세하고 포괄적으로

### 2. 구조 (HTML 형식)
- H2, H3 태그로 섹션 구분 (섹션 7~10개)
- 표(<table>)나 비교 리스트 적극 활용
- 단계별 가이드 형식 권장

### 3. 이미지 위치 표시
- [IMAGE_1], [IMAGE_2], [IMAGE_3], [IMAGE_4] 태그 삽입
- 정보성 콘텐츠이므로 [IMAGE_TYPE:SCREENSHOT] 우선 사용
- 공식 사이트, 정부 사이트 스크린샷이 신뢰도 높음

### 4. 절대 금지 사항

아래와 같은 "메타 문구"는 절대 사용 금지:
- "제가 블로그 글을 확장하겠어요"
- "다음과 같이 작성했어요"
- AI가 글을 쓴다는 것을 암시하는 모든 표현

### 5. 자연스러운 시작

**좋은 예시:**
- "혹시 {keyword} 때문에 머리 아프셨던 적 있으세요?"
- "매년 이맘때면 {keyword} 고민하시는 분들 많으시죠?"
- "저도 작년에 {keyword} 때문에 진짜 고생했어요."

### 6. 문체
- 친근하지만 신뢰감 있는 해요체
- 전문 용어는 쉽게 풀어서 설명
- 실제 경험담 형식으로 작성

### 7. 필수 포함 내용
- 정의/개념 설명
- 구체적인 방법/절차
- 주의사항
- 실제 예시
- 마무리 요약

### 8. 관련 사이트 링크 삽입 (매우 중요!)

웹검색 결과에서 신뢰할 수 있는 공식 사이트 링크를 본문에 자연스럽게 포함해.

**필수 포함:**
- 정부/공공기관 사이트 (홈택스, 정부24, 서민금융진흥원 등)
- 공식 서비스 사이트 (은행, 증권사, 공식 홈페이지)
- 뉴스 출처 링크

**링크 삽입 형식:**
<p>👉 <a href="https://실제URL" target="_blank" rel="noopener">사이트명 바로가기</a></p>

**삽입 위치:**
- 해당 내용 설명 직후 자연스럽게 배치
- 섹션당 1~2개 링크
- 글 마지막에 "관련 링크 모음" 섹션 필수 추가

**예시:**
청년도약계좌 가입은 서민금융진흥원에서 할 수 있어요.
<p>👉 <a href="https://www.kinfa.or.kr" target="_blank" rel="noopener">서민금융진흥원 바로가기</a></p>

**글 마지막 필수 섹션:**
<h3 style="font-size: 20px; font-weight: 600; color: #333; margin-top: 30px;">📌 관련 링크 모음</h3>
<ul style="padding-left: 20px;">
  <li style="margin: 10px 0;"><a href="URL1" target="_blank" rel="noopener">사이트1</a> - 간단 설명</li>
  <li style="margin: 10px 0;"><a href="URL2" target="_blank" rel="noopener">사이트2</a> - 간단 설명</li>
</ul>

## 출력 형식

바로 HTML 본문 내용만 출력해. 다른 설명 없이 <h2>로 시작해.
"""

# =============================================================================
# 제목 생성 프롬프트
# =============================================================================

TITLE_PROMPT = """
다음 키워드로 블로그 제목을 1개만 생성하세요.

키워드: {keyword}

[제목 규칙]
1. 클릭을 유도하는 매력적인 제목
2. 숫자 활용 권장 ("5가지", "TOP 7" 등)
3. 30~50자 사이
4. 이모지 사용하지 않음
5. 연도는 필요한 경우에만 포함

[제목 스타일 예시]
- "연말정산 환급 받는 5가지 꿀팁"
- "비트코인 전망, 전문가가 알려주는 핵심 포인트"
- "아이폰16 vs 갤럭시S25 완벽 비교 총정리"

제목만 출력하세요 (따옴표 없이):
"""

# =============================================================================
# 콘텐츠 확장 프롬프트
# =============================================================================

EXPAND_PROMPT = """
아래 블로그 글이 {current_length}자로 목표({target_length}자)보다 짧습니다.
각 섹션을 더 상세하게 확장해주세요.

[확장 방법]
1. 각 섹션에 구체적인 예시와 설명 추가
2. 새로운 소제목(H3) 섹션 2~3개 추가
3. 실제 사례나 통계 추가
4. 주의사항이나 팁 추가

[키워드]: {keyword}

[현재 글]:
{content}

## 절대 금지
- "확장하겠습니다", "추가하겠습니다" 같은 메타 문구
- AI가 글을 수정한다는 암시

기존 [IMAGE_TYPE:...], [IMAGE_N] 태그는 그대로 유지하세요.
확장된 HTML 본문만 출력하세요.
"""


# =============================================================================
# 프롬프트 생성 함수
# =============================================================================

def get_content_prompt(
    keyword: str,
    category: str,
    search_context: str,
    is_evergreen: bool = False
) -> str:
    """
    콘텐츠 생성 프롬프트 반환

    Args:
        keyword: 키워드
        category: 카테고리
        search_context: 웹검색 결과
        is_evergreen: 에버그린 콘텐츠 여부

    Returns:
        프롬프트 문자열
    """
    if is_evergreen:
        template = EVERGREEN_CONTENT_PROMPT
    else:
        template = TREND_CONTENT_PROMPT

    return template.format(
        keyword=keyword,
        category=category,
        search_context=search_context if search_context else "검색 결과 없음"
    )


def get_title_prompt(keyword: str) -> str:
    """제목 생성 프롬프트 반환"""
    return TITLE_PROMPT.format(keyword=keyword)


def get_expand_prompt(
    content: str,
    keyword: str,
    current_length: int,
    target_length: int
) -> str:
    """콘텐츠 확장 프롬프트 반환"""
    return EXPAND_PROMPT.format(
        content=content,
        keyword=keyword,
        current_length=current_length,
        target_length=target_length
    )
